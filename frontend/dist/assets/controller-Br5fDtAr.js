const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-BJyCFRl4.js","assets/index-anYD-FGg.js","assets/index-SGLETCTz.css"])))=>i.map(i=>d[i]);
import{ag as k,aS as z,T as g,aT as J,_ as O,aU as S,af as B,a7 as P,a9 as K,a8 as q,ab as Y,ac as G}from"./index-anYD-FGg.js";import{s as X,t as Z}from"./stringify-cJu1y5js.js";import{p as ee}from"./parse-typed-data-B5i2uSeh.js";import{g as x,f as ae}from"./url-XFQQWSb0.js";import{n as U,f as E,h as ne,j as te,v as ie,s as se}from"./accounts-DaLONHDH.js";import"./TypedData-DnI-ZWEX.js";const ce=e=>e;class re extends k{constructor({body:n,error:t,url:c}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${ce(c)}`,`Request body: ${X(n)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data}}const oe=-1;class de extends k{constructor(n,{code:t,docsPath:c,metaMessages:i,name:a,shortMessage:s}){super(s,{cause:n,docsPath:c,metaMessages:i||(n==null?void 0:n.metaMessages),name:a||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=a||n.name,this.code=n instanceof re?n.code:t??oe}}class F extends de{constructor(n,t){super(n,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class _ extends F{constructor(n){super(n,{code:_.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(_,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class R extends F{constructor(n){super(n,{code:R.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(R,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});const le="08c4b07e3ad25f1a27c14a4e8cecb6f0",H="eip155",L="wallet_addEthereumChain",ue=!0,M={requestedChains:"tw.wc.requestedChains",lastUsedChainId:"tw.wc.lastUsedChainId"};async function ve(e,n,t,c,i){var y,b;const a=await V(e,t,i),s=e.walletConnect;let{onDisplayUri:o}=s||{};if(!o&&i){const m=await x(t);o=p=>{const C=m.mobile.native||m.mobile.universal;if(!C){i(p);return}const I=ae(C,p).redirect;i(I)}}o&&a.events.addListener("display_uri",o);let d=s==null?void 0:s.optionalChains,r=e.chain;t==="global.safe"&&(d=$.map(g),r&&!d.includes(r)&&(r=void 0));const{rpcMap:u,requiredChain:l,optionalChains:h}=Q({client:e.client,chain:r,optionalChains:d});a.session&&await a.connect({...s!=null&&s.pairingTopic?{pairingTopic:s==null?void 0:s.pairingTopic}:{},optionalChains:h,chains:l?[l.id]:void 0,rpcMap:u}),A(h,c);const f=(await a.enable())[0];if(!f)throw new Error("No accounts found on provider.");const T=U(a.chainId),v=e.chain&&e.chain.id===T?e.chain:g(T);if(e){const m={optionalChains:(y=e.walletConnect)==null?void 0:y.optionalChains,chain:e.chain,pairingTopic:(b=e.walletConnect)==null?void 0:b.pairingTopic};c&&J(c,t,m)}return s!=null&&s.onDisplayUri&&a.events.removeListener("display_uri",s.onDisplayUri),W(f,v,a,n,c,e.client)}async function Ie(e,n,t,c,i){const a=c?await z(c,t):null,s=await V(a?{chain:a.chain,client:e.client,walletConnect:{pairingTopic:a.pairingTopic,optionalChains:a.optionalChains}}:{client:e.client,walletConnect:{}},t,i,!0),o=s.accounts[0];if(!o)throw new Error("No accounts found on provider.");const d=U(s.chainId),r=e.chain&&e.chain.id===d?e.chain:g(d);return W(o,r,s,n,c,e.client)}async function V(e,n,t,c=!1){var T,v,y,b;const i=await x(n),a=e.walletConnect,{EthereumProvider:s,OPTIONAL_EVENTS:o,OPTIONAL_METHODS:d}=await O(async()=>{const{EthereumProvider:m,OPTIONAL_EVENTS:w,OPTIONAL_METHODS:p}=await import("./index.es-BJyCFRl4.js").then(C=>C.i);return{EthereumProvider:m,OPTIONAL_EVENTS:w,OPTIONAL_METHODS:p}},__vite__mapDeps([0,1,2]));let r=a==null?void 0:a.optionalChains,u=e.chain;n==="global.safe"&&(r=$.map(g),u&&!r.includes(u)&&(u=void 0));const{rpcMap:l,requiredChain:h,optionalChains:D}=Q({client:e.client,chain:u,optionalChains:r}),f=await s.init({showQrModal:(a==null?void 0:a.showQrModal)===void 0?t?!1:ue:a.showQrModal,projectId:(a==null?void 0:a.projectId)||le,optionalMethods:d,optionalEvents:o,optionalChains:D,chains:h?[h.id]:void 0,metadata:{name:((T=a==null?void 0:a.appMetadata)==null?void 0:T.name)||E().name,description:((v=a==null?void 0:a.appMetadata)==null?void 0:v.description)||E().description,url:((y=a==null?void 0:a.appMetadata)==null?void 0:y.url)||E().url,icons:[((b=a==null?void 0:a.appMetadata)==null?void 0:b.logoUrl)||E().logoUrl]},rpcMap:l,qrModalOptions:a==null?void 0:a.qrModalOptions,disableProviderPing:!0});if(f.events.setMaxListeners(Number.POSITIVE_INFINITY),c||f.session&&await f.disconnect(),n!=="walletConnect"){async function m(){var p,C,I,N;const w=((N=(I=(C=(p=f.session)==null?void 0:p.peer)==null?void 0:C.metadata)==null?void 0:I.redirect)==null?void 0:N.native)||i.mobile.native||i.mobile.universal;t&&w&&await t(w)}f.signer.client.on("session_request_sent",m),f.events.addListener("disconnect",()=>{f.signer.client.off("session_request_sent",m)})}return f}function j({provider:e,address:n,client:t}){return{address:P(n),async sendTransaction(i){const a=await e.request({method:"eth_sendTransaction",params:[{gas:i.gas?q(i.gas):void 0,value:i.value?q(i.value):void 0,from:P(n),to:i.to,data:i.data}]});return Z({client:t,walletAddress:P(n),walletType:"walletConnect",transactionHash:a,chainId:i.chainId,contractAddress:i.to??void 0,gasPrice:i.gasPrice}),{transactionHash:a}},async signMessage({message:i}){const a=typeof i=="string"?Y(i):i.raw instanceof Uint8Array?G(i.raw):i.raw;return e.request({method:"personal_sign",params:[a,this.address]})},async signTypedData(i){const a=ee(i),{domain:s,message:o,primaryType:d}=a,r={EIP712Domain:te({domain:s}),...a.types};ie({domain:s,message:o,primaryType:d,types:r});const u=se({domain:s??{},message:o,primaryType:d,types:r});return await e.request({method:"eth_signTypedData_v4",params:[this.address,u]})}}}function W(e,n,t,c,i,a){const s=j({provider:t,address:e,client:a});async function o(){t.removeListener("accountsChanged",r),t.removeListener("chainChanged",u),t.removeListener("disconnect",d),await t.disconnect()}function d(){A([],i),i==null||i.removeItem(M.lastUsedChainId),o(),c.emit("disconnect",void 0)}function r(l){if(l[0]){const h=j({provider:t,address:P(l[0]),client:a});c.emit("accountChanged",h),c.emit("accountsChanged",l)}else d()}function u(l){const h=g(U(l));c.emit("chainChanged",h),i==null||i.setItem(M.lastUsedChainId,String(l))}return t.on("accountsChanged",r),t.on("chainChanged",u),t.on("disconnect",d),t.on("session_delete",d),[s,n,o,l=>me(t,l,i)]}function he(e){var n,t;return((t=(n=e.session)==null?void 0:n.namespaces[H])==null?void 0:t.methods)||[]}function fe(e){var t,c,i;return((i=(c=(t=e.session)==null?void 0:t.namespaces[H])==null?void 0:c.chains)==null?void 0:i.map(a=>Number.parseInt(a.split(":")[1]||"")))??[]}async function me(e,n,t){var i,a;const c=n.id;try{const s=fe(e),o=he(e);if(!s.includes(c)&&o.includes(L)){const r=await K(n),u=[...new Set([...((i=n.blockExplorers)==null?void 0:i.map(h=>h.url))||[],...((a=r.explorers)==null?void 0:a.map(h=>h.url))||[]])];await e.request({method:L,params:[{chainId:q(r.chainId),chainName:r.name,nativeCurrency:r.nativeCurrency,rpcUrls:ne(r),blockExplorerUrls:u.length>0?u:void 0}]});const l=await pe(t);l.push(c),A(l,t)}await e.request({method:"wallet_switchEthereumChain",params:[{chainId:q(c)}]})}catch(s){const o=typeof s=="string"?s:s==null?void 0:s.message;throw/user rejected request/i.test(o)?new _(s):new R(s)}}function A(e,n){n==null||n.setItem(M.requestedChains,B(e))}async function pe(e){const n=await e.getItem(M.requestedChains);return n?JSON.parse(n):[]}function Q(e){const n={};e.chain&&(n[e.chain.id]=S({chain:e.chain,client:e.client}));const t=((e==null?void 0:e.optionalChains)||[]).slice(0,10);for(const c of t)n[c.id]=S({chain:c,client:e.client});return!e.chain&&t.length===0&&(n[1]=g(1).rpc),{rpcMap:n,requiredChain:e.chain?e.chain:void 0,optionalChains:t.length>0?t.map(c=>c.id):[1]}}const $=[1,11155111,42161,43114,8453,1313161554,84532,56,42220,100,10,137,1101,324,534352];export{Ie as autoConnectWC,ve as connectWC};
