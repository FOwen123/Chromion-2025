import{Z as Qe,j as e,r as i,U as te,x as Te,$ as X}from"./index-anYD-FGg.js";import{a as h,S as g,K as Ye,i as oe,T as A,B as Y,c as ae,L as Be,N as Ke,Q as Ze,M as se,R as Xe,x as J,j as xe,U as Je,f as fe,r as et,b as tt,h as Oe,V as nt,X as it,Y as rt,F as we}from"./ConnectEmbed-Bpe-CHh8.js";import{l as ee,p as Me,o as lt}from"./ConnectWalletSocialOptions-BenzlA2-.js";import at from"./AllWalletsUI-Bno1Snov.js";import{hasStoredPasskey as ot}from"./passkeys-DpDg0PTU.js";import{l as st}from"./oauth-CC2pU2pg.js";function ct(){return Qe("useAddConnectedWallet").addConnectedWallet}function Se(t){return e.jsxs(h,{animate:"fadein",children:[e.jsx(g,{y:"xxl"}),e.jsx(h,{flex:"row",center:"x",children:e.jsx(Ye,{size:oe["3xl"]})}),e.jsx(g,{y:"lg"}),e.jsx(A,{center:!0,color:"primaryText",size:"md",children:t.title}),e.jsx(g,{y:"xl"}),e.jsx(g,{y:"xxl"}),e.jsx(Y,{variant:"accent",fullWidth:!0,onClick:t.onTryAgain,children:"Try Again"})]})}function ke(t){return e.jsxs(h,{animate:"fadein",children:[e.jsx(g,{y:"xxl"}),e.jsxs(h,{flex:"row",center:"x",style:{position:"relative"},children:[e.jsx(ae,{size:"4xl",color:"accentText"}),e.jsx(h,{color:"accentText",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:t.icon})]}),e.jsx(g,{y:"xl"}),e.jsx(A,{center:!0,color:"primaryText",size:"lg",children:t.title}),e.jsx(g,{y:"md"}),e.jsx(A,{multiline:!0,center:!0,children:t.subtitle}),e.jsx(g,{y:"xxl"}),e.jsx(g,{y:"xxl"})]})}function _t(t){var k;const{wallet:n,done:r}=t,o=ct(),l=i.useRef(void 0),[u,x]=i.useState("selecting"),[p,m]=i.useState(),[S,d]=i.useState(!1),b=te(n)?{id:n.id,partnerId:(k=n.getConfig())==null?void 0:k.partnerId}:void 0,v=()=>{x("selecting"),l.current=void 0,t.onBack()};async function w(y){x("loading"),m(void 0),l.current=y;try{t.isLinking?await ee({client:t.client,strategy:"wallet",wallet:y,chain:t.chain||n.getChain()||Te(1),ecosystem:b}):await n.connect({client:t.client,strategy:"wallet",wallet:y,chain:t.chain||y.getChain()||Te(1)}),o(y),r()}catch(f){m(f instanceof Error?f.message:"Unknown error"),x("error")}}return l.current?e.jsxs(h,{animate:"fadein",fullHeight:!0,flex:"column",children:[e.jsx(h,{p:"lg",children:e.jsx(se,{title:t.isLinking?t.inAppLocale.linkWallet:t.inAppLocale.signInWithWallet,onBack:v})}),e.jsx(h,{px:t.size==="wide"?"xxl":"lg",expand:!0,flex:"column",center:"y",children:e.jsx("div",{children:u==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{onTryAgain:()=>{if(!l.current)throw new Error("Failed to connect to unknown wallet");w(l.current)},title:p||"Failed to Login"}),e.jsx(g,{y:"lg"})]}):e.jsx(e.Fragment,{children:e.jsx(ke,{title:"Sign in with your wallet",subtitle:"A pop-up prompt will appear to sign-in and verify your wallet",icon:e.jsx(Xe,{id:l.current.id??"",size:oe.xl,client:t.client})})})})})]}):S?e.jsx(i.Suspense,{fallback:e.jsx(Be,{}),children:e.jsx(at,{onBack:()=>d(!1),onSelect:async y=>{w(y),d(!1)},client:t.client,connectLocale:t.locale,recommendedWallets:void 0,specifiedWallets:[],size:t.size,disableSelectionDataReset:!0})}):e.jsx(Ke,{title:t.locale.connectAWallet,wallets:Ze(),selectWallet:async y=>{w(y)},onShowAll:()=>{d(!0)},done:()=>{},goBack:v,setModalVisibility:()=>{},client:t.client,connectLocale:t.locale,hideHeader:!1,recommendedWallets:void 0,chain:n.getChain(),showAllWallets:!0,chains:[],size:t.size,meta:t.meta||{},walletConnect:t.walletConnect,modalHeader:{title:t.isLinking?t.inAppLocale.linkWallet:t.inAppLocale.signInWithWallet,onBack:v},walletIdsToHide:["inApp"],disableSelectionDataReset:!0})}function Ht(t){var v;const n=t.locale,r=n.socialLoginScreen,[o,l]=i.useState(void 0),{done:u,wallet:x}=t,[p,m]=i.useState("connecting"),S=async()=>{var k,y;const w={client:t.client,ecosystem:te(x)?{id:x.id,partnerId:(k=x.getConfig())==null?void 0:k.partnerId}:void 0,strategy:"guest"};try{await x.connect(w),await J("guest",X),m("connected"),u()}catch(f){m("error"),f instanceof Error&&((y=f==null?void 0:f.message)!=null&&y.includes("PAYMENT_METHOD_REQUIRED"))&&l(n.maxAccountsExceeded),console.error("Error generating guest account",f)}},d=(v=t.state)==null?void 0:v.guestLogin,b=i.useRef(!1);return i.useEffect(()=>{b.current||d&&(b.current=!0,m("connecting"),d.connectionPromise.then(()=>{u(),m("connected")}).catch(w=>{l(w.message),m("error")}))},[u,d]),e.jsx(h,{animate:"fadein",flex:"column",fullHeight:!0,children:e.jsxs(h,{flex:"column",expand:!0,p:"lg",style:{paddingBottom:0},children:[t.goBack&&e.jsx(se,{title:r.title,onBack:t.goBack}),t.size==="compact"?e.jsx(g,{y:"xl"}):null,e.jsxs(h,{flex:"column",center:"both",expand:!0,style:{textAlign:"center",minHeight:"250px"},children:[p!=="error"&&e.jsxs(h,{animate:"fadein",children:[e.jsx(A,{color:"primaryText",center:!0,multiline:!0,style:{maxWidth:"250px"},children:"Generating your guest account"}),e.jsx(g,{y:"xl"}),e.jsx(h,{center:"x",flex:"row",children:e.jsx(ae,{size:"lg",color:"accentText"})}),e.jsx(g,{y:"xxl"})]}),p==="error"&&e.jsxs(h,{animate:"fadein",children:[o?e.jsx(A,{center:!0,color:"danger",children:o}):e.jsx(A,{color:"danger",children:r.failed}),e.jsx(g,{y:"lg"}),e.jsx(Y,{variant:"primary",onClick:S,children:r.retry}),e.jsx(g,{y:"xxl"})]})]})]})})}const ve=xe({animation:`${Je} 0.15s ease-in`});var ut=Object.defineProperty,dt=Object.defineProperties,gt=Object.getOwnPropertyDescriptors,ge=Object.getOwnPropertySymbols,ze=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,Re=(t,n,r)=>n in t?ut(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,xt=(t,n)=>{for(var r in n||(n={}))ze.call(n,r)&&Re(t,r,n[r]);if(ge)for(var r of ge(n))De.call(n,r)&&Re(t,r,n[r]);return t},ft=(t,n)=>dt(t,gt(n)),ht=(t,n)=>{var r={};for(var o in t)ze.call(t,o)&&n.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&ge)for(var o of ge(t))n.indexOf(o)<0&&De.call(t,o)&&(r[o]=t[o]);return r};function mt(t){let n=setTimeout(t,0),r=setTimeout(t,10),o=setTimeout(t,50);return[n,r,o]}function yt(t){let n=i.useRef();return i.useEffect(()=>{n.current=t}),n.current}var pt=18,Fe=40,jt=`${Fe}px`,vt=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function wt({containerRef:t,inputRef:n,pushPasswordManagerStrategy:r,isFocused:o}){let[l,u]=i.useState(!1),[x,p]=i.useState(!1),[m,S]=i.useState(!1),d=i.useMemo(()=>r==="none"?!1:(r==="increase-width"||r==="experimental-no-flickering")&&l&&x,[l,x,r]),b=i.useCallback(()=>{let v=t.current,w=n.current;if(!v||!w||m||r==="none")return;let k=v,y=k.getBoundingClientRect().left+k.offsetWidth,f=k.getBoundingClientRect().top+k.offsetHeight/2,j=y-pt,z=f;document.querySelectorAll(vt).length===0&&document.elementFromPoint(j,z)===v||(u(!0),S(!0))},[t,n,m,r]);return i.useEffect(()=>{let v=t.current;if(!v||r==="none")return;function w(){let y=window.innerWidth-v.getBoundingClientRect().right;p(y>=Fe)}w();let k=setInterval(w,1e3);return()=>{clearInterval(k)}},[t,r]),i.useEffect(()=>{let v=o||document.activeElement===n.current;if(r==="none"||!v)return;let w=setTimeout(b,0),k=setTimeout(b,2e3),y=setTimeout(b,5e3),f=setTimeout(()=>{S(!0)},6e3);return()=>{clearTimeout(w),clearTimeout(k),clearTimeout(y),clearTimeout(f)}},[n,o,r,b]),{hasPWMBadge:l,willPushPWMBadge:d,PWM_BADGE_SPACE_WIDTH:jt}}var St=i.createContext({}),_e=i.forwardRef((t,n)=>{var r=t,{value:o,onChange:l,maxLength:u,textAlign:x="left",pattern:p,placeholder:m,inputMode:S="numeric",onComplete:d,pushPasswordManagerStrategy:b="increase-width",pasteTransformer:v,containerClassName:w,noScriptCSSFallback:k=kt,render:y,children:f}=r,j=ht(r,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),z,F,N,G,L;let[B,ce]=i.useState(typeof j.defaultValue=="string"?j.defaultValue:""),c=o??B,P=yt(c),I=i.useCallback(a=>{l==null||l(a),ce(a)},[l]),D=i.useMemo(()=>p?typeof p=="string"?new RegExp(p):p:null,[p]),C=i.useRef(null),he=i.useRef(null),me=i.useRef({value:c,onChange:I,isIOS:typeof window<"u"&&((F=(z=window==null?void 0:window.CSS)==null?void 0:z.supports)==null?void 0:F.call(z,"-webkit-touch-callout","none"))}),ue=i.useRef({prev:[(N=C.current)==null?void 0:N.selectionStart,(G=C.current)==null?void 0:G.selectionEnd,(L=C.current)==null?void 0:L.selectionDirection]});i.useImperativeHandle(n,()=>C.current,[]),i.useEffect(()=>{let a=C.current,s=he.current;if(!a||!s)return;me.current.value!==a.value&&me.current.onChange(a.value),ue.current.prev=[a.selectionStart,a.selectionEnd,a.selectionDirection];function W(){if(document.activeElement!==a){ie(null),re(null);return}let E=a.selectionStart,T=a.selectionEnd,de=a.selectionDirection,O=a.maxLength,V=a.value,_=ue.current.prev,H=-1,$=-1,q;if(V.length!==0&&E!==null&&T!==null){let Ue=E===T,Ve=E===V.length&&V.length<O;if(Ue&&!Ve){let Q=E;if(Q===0)H=0,$=1,q="forward";else if(Q===O)H=Q-1,$=Q,q="backward";else if(O>1&&V.length>1){let je=0;if(_[0]!==null&&_[1]!==null){q=Q<_[1]?"backward":"forward";let qe=_[0]===_[1]&&_[0]<O;q==="backward"&&!qe&&(je=-1)}H=je+Q,$=je+Q+1}}H!==-1&&$!==-1&&H!==$&&C.current.setSelectionRange(H,$,q)}let We=H!==-1?H:E,Pe=$!==-1?$:T,Ge=q??de;ie(We),re(Pe),ue.current.prev=[We,Pe,Ge]}if(document.addEventListener("selectionchange",W,{capture:!0}),W(),document.activeElement===a&&ye(!0),!document.getElementById("input-otp-style")){let E=document.createElement("style");if(E.id="input-otp-style",document.head.appendChild(E),E.sheet){let T="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";le(E.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),le(E.sheet,`[data-input-otp]:autofill { ${T} }`),le(E.sheet,`[data-input-otp]:-webkit-autofill { ${T} }`),le(E.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),le(E.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let M=()=>{s&&s.style.setProperty("--root-height",`${a.clientHeight}px`)};M();let R=new ResizeObserver(M);return R.observe(a),()=>{document.removeEventListener("selectionchange",W,{capture:!0}),R.disconnect()}},[]);let[be,Ee]=i.useState(!1),[ne,ye]=i.useState(!1),[U,ie]=i.useState(null),[K,re]=i.useState(null);i.useEffect(()=>{mt(()=>{var a,s,W,M;(a=C.current)==null||a.dispatchEvent(new Event("input"));let R=(s=C.current)==null?void 0:s.selectionStart,E=(W=C.current)==null?void 0:W.selectionEnd,T=(M=C.current)==null?void 0:M.selectionDirection;R!==null&&E!==null&&(ie(R),re(E),ue.current.prev=[R,E,T])})},[c,ne]),i.useEffect(()=>{P!==void 0&&c!==P&&P.length<u&&c.length===u&&(d==null||d(c))},[u,d,P,c]);let Z=wt({containerRef:he,inputRef:C,pushPasswordManagerStrategy:b,isFocused:ne}),Ce=i.useCallback(a=>{let s=a.currentTarget.value.slice(0,u);if(s.length>0&&D&&!D.test(s)){a.preventDefault();return}typeof P=="string"&&s.length<P.length&&document.dispatchEvent(new Event("selectionchange")),I(s)},[u,I,P,D]),Ae=i.useCallback(()=>{var a;if(C.current){let s=Math.min(C.current.value.length,u-1),W=C.current.value.length;(a=C.current)==null||a.setSelectionRange(s,W),ie(s),re(W)}ye(!0)},[u]),Le=i.useCallback(a=>{var s,W;let M=C.current;if(!v&&(!me.current.isIOS||!a.clipboardData||!M))return;let R=a.clipboardData.getData("text/plain"),E=v?v(R):R;a.preventDefault();let T=(s=C.current)==null?void 0:s.selectionStart,de=(W=C.current)==null?void 0:W.selectionEnd,O=(T!==de?c.slice(0,T)+E+c.slice(de):c.slice(0,T)+E+c.slice(T)).slice(0,u);if(O.length>0&&D&&!D.test(O))return;M.value=O,I(O);let V=Math.min(O.length,u-1),_=O.length;M.setSelectionRange(V,_),ie(V),re(_)},[u,I,D,c]),He=i.useMemo(()=>({position:"relative",cursor:j.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[j.disabled]),Ie=i.useMemo(()=>({position:"absolute",inset:0,width:Z.willPushPWMBadge?`calc(100% + ${Z.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:Z.willPushPWMBadge?`inset(0 ${Z.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:x,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[Z.PWM_BADGE_SPACE_WIDTH,Z.willPushPWMBadge,x]),$e=i.useMemo(()=>i.createElement("input",ft(xt({autoComplete:j.autoComplete||"one-time-code"},j),{"data-input-otp":!0,"data-input-otp-placeholder-shown":c.length===0||void 0,"data-input-otp-mss":U,"data-input-otp-mse":K,inputMode:S,pattern:D==null?void 0:D.source,"aria-placeholder":m,style:Ie,maxLength:u,value:c,ref:C,onPaste:a=>{var s;Le(a),(s=j.onPaste)==null||s.call(j,a)},onChange:Ce,onMouseOver:a=>{var s;Ee(!0),(s=j.onMouseOver)==null||s.call(j,a)},onMouseLeave:a=>{var s;Ee(!1),(s=j.onMouseLeave)==null||s.call(j,a)},onFocus:a=>{var s;Ae(),(s=j.onFocus)==null||s.call(j,a)},onBlur:a=>{var s;ye(!1),(s=j.onBlur)==null||s.call(j,a)}})),[Ce,Ae,Le,S,Ie,u,K,U,j,D==null?void 0:D.source,c]),pe=i.useMemo(()=>({slots:Array.from({length:u}).map((a,s)=>{var W;let M=ne&&U!==null&&K!==null&&(U===K&&s===U||s>=U&&s<K),R=c[s]!==void 0?c[s]:null,E=c[0]!==void 0?null:(W=m==null?void 0:m[s])!=null?W:null;return{char:R,placeholderChar:E,isActive:M,hasFakeCaret:M&&R===null}}),isFocused:ne,isHovering:!j.disabled&&be}),[ne,be,u,K,U,j.disabled,c]),Ne=i.useMemo(()=>y?y(pe):i.createElement(St.Provider,{value:pe},f),[f,pe,y]);return i.createElement(i.Fragment,null,k!==null&&i.createElement("noscript",null,i.createElement("style",null,k)),i.createElement("div",{ref:he,"data-input-otp-container":!0,style:He,className:w},Ne,i.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},$e)))});_e.displayName="Input";function le(t,n){try{t.insertRule(n)}catch{console.error("input-otp could not insert CSS rule:",n)}}var kt=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;function bt(t){return e.jsx(Et,{children:e.jsx(_e,{onComplete:()=>{t.onEnter()},maxLength:6,value:t.value,render:({slots:n})=>e.jsx(h,{flex:"row",gap:"xs",center:"both",children:n.map((r,o)=>e.jsx(Ct,{...r,isInvalid:t.isInvalid},o))}),onChange:n=>{t.setValue(n)}})})}const Et=xe({"& input":{maxWidth:"100%"}});function Ct(t){return e.jsxs(It,{"data-active":t.isActive,"data-error":t.isInvalid,children:[t.char!==null&&e.jsx("div",{children:t.char}),t.hasFakeCaret&&e.jsx(Lt,{})]})}const At=nt`
  0%, 100% {
    opacity: 0;
  },
  50% {
    opacity: 1;
  }
  `,Lt=xe(t=>{const n=fe();return{position:"absolute",pointerEvents:"none",inset:0,display:"flex",alignItems:"center",justifyContent:"center",animation:`${At} 1s infinite`,"&::before":{content:"''",display:"block",width:"1.5px",height:"1em",backgroundColor:n.colors.primaryText}}}),It=xe(t=>{const n=fe();return{position:"relative",width:"40px",height:"40px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",fontSize:Oe.md,padding:tt.xs,boxSizing:"border-box",transition:"color 200ms ease",border:`2px solid ${n.colors.borderColor}`,"&[data-active='true']":{borderColor:n.colors.accentText},color:n.colors.primaryText,borderRadius:et.lg,"&[data-error='true']":{borderColor:n.colors.danger}}});function $t(t){var ce;const{wallet:n,done:r,goBack:o,userInfo:l}=t,u=t.size==="wide",x=t.locale,[p,m]=i.useState(""),[S,d]=i.useState("idle"),[b,v]=i.useState(),[w,k]=i.useState("sending"),[y,f]=i.useState(0),j=te(n)?{id:n.id,partnerId:(ce=n.getConfig())==null?void 0:ce.partnerId}:void 0,[z]=i.useState("base"),F=i.useCallback(async()=>{m(""),d("idle"),k("sending");try{if("email"in l)await Me({ecosystem:j,email:l.email,strategy:"email",client:t.client}),k("sent"),f(60);else if("phone"in l)await Me({ecosystem:j,phoneNumber:l.phone,strategy:"phone",client:t.client}),k("sent"),f(60);else throw new Error("Invalid userInfo")}catch(c){console.error(c),d("idle"),k("error")}},[t.client,l,j]);async function N(c){if("email"in l)await n.connect({chain:t.chain,strategy:"email",email:l.email,verificationCode:c,client:t.client}),await J("email",X);else if("phone"in l)await n.connect({chain:t.chain,strategy:"phone",phoneNumber:l.phone,verificationCode:c,client:t.client}),await J("phone",X);else throw new Error("Invalid userInfo")}async function G(c){"email"in l?await ee({client:t.client,strategy:"email",email:l.email,verificationCode:c,ecosystem:j}):"phone"in l&&await ee({client:t.client,strategy:"phone",phoneNumber:l.phone,verificationCode:c,ecosystem:j})}const L=async c=>{var P;if(c.length===6){d("verifying");try{t.isLinking?await G(c):await N(c),r(),d("valid")}catch(I){I instanceof Error&&((P=I==null?void 0:I.message)!=null&&P.includes("PAYMENT_METHOD_REQUIRED"))?d("payment_required"):I instanceof Error&&(I.message.toLowerCase().includes("link")||I.message.toLowerCase().includes("profile"))?(d("linking_error"),v(I.message)):d("invalid"),console.error("Authentication Error",I)}}},B=i.useRef(!1);return i.useEffect(()=>{B.current||(B.current=!0,F())},[F]),i.useEffect(()=>{if(y<=0)return;const c=setInterval(()=>{f(P=>P<=1?(clearInterval(c),0):P-1)},1e3);return()=>clearInterval(c)},[y]),z==="base"?e.jsxs(h,{fullHeight:!0,flex:"column",animate:"fadein",children:[e.jsx(h,{p:"lg",children:e.jsx(se,{title:x.signIn,onBack:o})}),e.jsx(h,{expand:!0,flex:"column",center:"y",children:e.jsxs("form",{onSubmit:c=>{c.preventDefault()},children:[e.jsxs(h,{flex:"column",center:"x",px:"lg",children:[!u&&e.jsx(g,{y:"xl"}),e.jsx(A,{children:x.emailLoginScreen.enterCodeSendTo}),e.jsx(g,{y:"sm"}),e.jsx(A,{color:"primaryText",children:"email"in l?l.email:l.phone}),e.jsx(g,{y:"xl"})]}),e.jsx(bt,{isInvalid:S==="invalid",digits:6,value:p,setValue:c=>{m(c),d("idle")},onEnter:()=>{L(p)}}),S==="invalid"&&e.jsxs(ve,{children:[e.jsx(g,{y:"md"}),e.jsx(A,{size:"sm",color:"danger",center:!0,children:x.emailLoginScreen.invalidCode})]}),S==="linking_error"&&e.jsxs(ve,{children:[e.jsx(g,{y:"md"}),e.jsx(A,{size:"sm",color:"danger",center:!0,children:b||"Failed to verify code"})]}),S==="payment_required"&&e.jsxs(ve,{children:[e.jsx(g,{y:"md"}),e.jsx(A,{size:"sm",color:"danger",center:!0,children:x.maxAccountsExceeded})]}),e.jsx(g,{y:"xl"}),e.jsx(h,{px:u?"xxl":"lg",children:S==="verifying"?e.jsx(e.Fragment,{children:e.jsx(h,{flex:"row",center:"x",animate:"fadein",children:e.jsx(ae,{size:"lg",color:"accentText"})})}):e.jsx(h,{animate:"fadein",children:e.jsx(Y,{onClick:()=>L(p),variant:"accent",type:"submit",style:{width:"100%"},children:x.emailLoginScreen.verify})},"btn-container")}),e.jsx(g,{y:"xl"}),!u&&e.jsx(it,{}),e.jsxs(h,{p:u?void 0:"lg",gap:"xs",children:[w==="error"&&e.jsx(A,{size:"sm",center:!0,color:"danger",children:x.emailLoginScreen.failedToSendCode}),w==="sending"&&e.jsxs(h,{flex:"row",center:"both",gap:"xs",style:{textAlign:"center"},children:[e.jsx(A,{size:"sm",children:x.emailLoginScreen.sendingCode}),e.jsx(ae,{size:"xs",color:"secondaryText"})]}),w!=="sending"&&e.jsx(Wt,{onClick:y===0?F:void 0,type:"button",style:{opacity:y>0?.5:1,cursor:y>0?"default":"pointer"},children:y>0?`Resend code in ${y} seconds`:x.emailLoginScreen.resendCode})]})]})})]}):null}const Wt=rt(t=>{const n=fe();return{all:"unset",color:n.colors.accentText,fontSize:Oe.sm,cursor:"pointer",textAlign:"center",fontWeight:500,width:"100%","&:hover":{color:n.colors.primaryText}}});function Nt(t){const{wallet:n,done:r,client:o,chain:l,size:u,locale:x}=t,[p,m]=i.useState("loading"),S=i.useRef(!1);return i.useEffect(()=>{S.current||(S.current=!0,ot(o,te(n.id)?n.id:void 0).then(d=>{m(d?"login":"select")}).catch(()=>{m("select")}))},[o,n.id]),e.jsxs(h,{animate:"fadein",fullHeight:!0,flex:"column",children:[e.jsx(h,{p:"lg",children:e.jsx(se,{title:t.isLinking?x.passkeys.linkPasskey:x.passkeys.title,onBack:t.onBack})}),e.jsx(h,{px:u==="wide"?"xxl":"lg",expand:!0,flex:"column",center:"y",children:e.jsxs("div",{children:[p==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx(Be,{}),e.jsx(g,{y:"xxl"})]}),p==="select"&&e.jsx(Mt,{onSignin:()=>{m("login")},onSignup:()=>{m("signup")}}),p==="login"&&e.jsx(Pt,{wallet:n,client:o,done:r,onCreate:()=>{m("signup")},chain:l,isLinking:t.isLinking}),p==="signup"&&e.jsx(Tt,{wallet:n,client:o,done:r,chain:l,isLinking:t.isLinking})]})})]})}function Pt(t){const{wallet:n,done:r,client:o,chain:l}=t,[u,x]=i.useState("loading"),[p,m]=i.useState();async function S(){x("loading");try{t.isLinking?await ee({client:o,strategy:"passkey",type:"sign-in"}).catch(b=>{throw m(b.message),b}):(await n.connect({client:o,strategy:"passkey",type:"sign-in",chain:l}),await J("passkey",X)),r()}catch(b){console.error("Failed to login with passkey",b),x("error")}}const d=i.useRef(!1);return i.useEffect(()=>{d.current||(d.current=!0,S())}),u==="loading"?e.jsx(ke,{title:"Requesting Passkey",subtitle:"A pop-up prompt will appear to sign-in and verify your passkey",icon:e.jsx(we,{size:oe.xxl})}):u==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{onTryAgain:S,title:p||"Failed to Login"}),e.jsx(g,{y:"sm"}),e.jsx(Y,{variant:"outline",fullWidth:!0,onClick:t.onCreate,children:"Create a new Passkey"}),e.jsx(g,{y:"lg"})]}):null}function Tt(t){var v;const{wallet:n,done:r,client:o,chain:l}=t,[u,x]=i.useState(),[p,m]=i.useState("loading"),S=te(n)?{id:n.id,partnerId:(v=n.getConfig())==null?void 0:v.partnerId}:void 0;async function d(){m("loading");try{t.isLinking?await ee({client:o,strategy:"passkey",type:"sign-up",ecosystem:S}):(await n.connect({client:o,strategy:"passkey",type:"sign-up",chain:l}),await J("passkey",X)),r()}catch(w){console.error(w),w instanceof Error&&x(`Error creating passkey: ${w.message}`),m("error")}}const b=i.useRef(!1);return i.useEffect(()=>{b.current||(b.current=!0,d())}),p==="loading"?e.jsx(ke,{title:"Creating Passkey",subtitle:"A pop-up prompt will appear to sign-in and verify your passkey",icon:e.jsx(we,{size:oe.xxl})}):p==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{onTryAgain:d,title:u||"Failed to create passkey"}),e.jsx(g,{y:"lg"})]}):null}function Mt(t){return e.jsxs(h,{children:[e.jsx(g,{y:"xxl"}),e.jsx(h,{flex:"row",center:"x",color:"accentText",children:e.jsx(we,{size:oe["4xl"]})}),e.jsx(g,{y:"xl"}),e.jsx(g,{y:"xxl"}),e.jsx(Y,{variant:"accent",onClick:t.onSignup,fullWidth:!0,children:"Create a Passkey"}),e.jsx(g,{y:"sm"}),e.jsx(Y,{variant:"outline",onClick:t.onSignin,fullWidth:!0,children:"I have a Passkey"}),e.jsx(g,{y:"lg"})]})}function Gt(t){var k,y;const n=t.locale,r=n.socialLoginScreen,o=fe(),l=te(t.wallet)?{id:t.wallet.id,partnerId:(k=t.wallet.getConfig())==null?void 0:k.partnerId}:void 0,[u,x]=i.useState(void 0),{done:p,wallet:m}=t,[S,d]=i.useState("connecting"),b=async()=>{var z,F,N,G;const f=m.getConfig(),j=f&&"auth"in f?((z=f==null?void 0:f.auth)==null?void 0:z.mode)??"popup":"popup";if(f&&"auth"in f&&j!=="popup"&&!t.isLinking)return st({authOption:t.socialAuth,client:t.client,ecosystem:l,redirectUrl:(F=f==null?void 0:f.auth)==null?void 0:F.redirectUrl,mode:(N=f==null?void 0:f.auth)==null?void 0:N.mode});try{const L=lt({authOption:t.socialAuth,themeObj:o,client:t.client,ecosystem:l});if(!L)throw new Error(`Failed to open ${t.socialAuth} login window`);d("connecting"),t.isLinking?await ee({client:t.client,strategy:t.socialAuth,openedWindow:L,closeOpenedWindow:B=>{B.close()},ecosystem:l}).catch(B=>{throw x(B.message),B}):await m.connect({chain:t.chain,strategy:t.socialAuth,openedWindow:L,closeOpenedWindow:B=>{B.close()},client:t.client}),await J(t.socialAuth,X),d("connected"),p()}catch(L){d("error"),L instanceof Error&&((G=L==null?void 0:L.message)!=null&&G.includes("PAYMENT_METHOD_REQUIRED"))&&x(n.maxAccountsExceeded),console.error(`Error signing in with ${t.socialAuth}`,L)}},v=(y=t.state)==null?void 0:y.socialLogin,w=i.useRef(!1);return i.useEffect(()=>{w.current||v&&(w.current=!0,d("connecting"),v.connectionPromise.then(()=>{p(),d("connected")}).catch(f=>{x(f.message),d("error")}))},[p,v]),e.jsx(h,{animate:"fadein",flex:"column",fullHeight:!0,children:e.jsxs(h,{flex:"column",expand:!0,p:"lg",style:{paddingBottom:0},children:[t.goBack&&e.jsx(se,{title:t.isLinking?t.connectLocale.manageWallet.linkProfile:r.title,onBack:t.goBack}),t.size==="compact"?e.jsx(g,{y:"xl"}):null,e.jsxs(h,{flex:"column",center:"both",expand:!0,style:{textAlign:"center",minHeight:"250px"},children:[S!=="error"&&e.jsxs(h,{animate:"fadein",children:[e.jsx(A,{color:"primaryText",center:!0,multiline:!0,style:{maxWidth:"250px"},children:r.instruction}),e.jsx(g,{y:"xl"}),e.jsx(h,{center:"x",flex:"row",children:e.jsx(ae,{size:"lg",color:"accentText"})}),e.jsx(g,{y:"xxl"})]}),S==="error"&&e.jsxs(h,{animate:"fadein",children:[u?e.jsx(A,{center:!0,color:"danger",children:u}):e.jsx(A,{color:"danger",children:r.failed}),e.jsx(g,{y:"lg"}),e.jsx(Y,{variant:"primary",onClick:b,children:r.retry}),e.jsx(g,{y:"xxl"})]})]})]})})}export{Ht as G,$t as O,Nt as P,Gt as S,_t as W};
